# -*- coding:utf-8 -*-
# author: origin
# email: 1194542196@qq.com
# date: 2021/7/15

import json

from core.golaxy.spider.requester import GolaxyRequestsRequester

# # 新闻数据kafka配置信息
# KAFKA_NEWS_KEY_SCHEMA = '{"name":"_id" ,"type": "string"}'
# KAFKA_NEWS_VALUE_SCHEMA = '{"type":"record","name":"news_doc","fields": [{"name":"_key","type":"string"},{"name":"_id","type":"string"},{"name":"_spec","type":"string"},{"name":"_ch","type":"long"},{"name":"_ex","type":"long"},{"name":"gt","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"pt","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"it","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"ut","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"nrd","type":"long"},{"name":"nrply","type":"long"},{"name":"url","type":"string"},{"name":"purl","type":"string"},{"name":"title","type":"string"},{"name":"author","type":"string"},{"name":"cont","type":"string"},{"name":"abstr","type":"string"},{"name":"lpic","type":{"type": "array", "items": "string"}},{"name":"lvideo","type":{"type": "array", "items": "string"}},{"name":"lkey","type":{"type": "array", "items": "string"}},{"name":"lang","type":"string"},{"name":"vkey","type":{"type":"array","items":{"type":"record","name":"vkey","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vpers","type":{"type":"array","items":{"type":"record","name":"vpers","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vorg","type":{"type":"array","items":{"type":"record","name":"vorg","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vrgn","type":{"type":"array","items":{"type":"record","name":"vrgn","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"sent","type":"long"},{"name":"i_bid","type":"long"},{"name":"i_bn","type":"string"},{"name":"i_sid","type":"long"},{"name":"i_sn","type":"string"},{"name":"adp","type":"string"},{"name":"loc","type":"string"},{"name":"source","type":"string"},{"name":"raw_cont","type":"string"}]}'
# KAFKA_NEWS_HEADERS = {"Content-Type": "application/vnd.kafka.avro.v2+json", "Accept": "application/vnd.kafka.v2+json"}
# KAFKA_NEWS_URL = "http://10.20.18.6:8082/topics/news_doc_crawler_v3_tmp"
#
# # app新闻数据kafka配置信息
# KAFKA_APPNEWS_KEY_SCHEMA = '{"name":"_id" ,"type": "string"}'
# KAFKA_APPNEWS_VALUE_SCHEMA = '{"type":"record","name":"appnews_doc","fields": [{"name":"_key","type":"string"},{"name":"_spec","type":"string"},{"name":"_id","type":"string"},{"name":"_ch","type":"long"},{"name":"_ex","type":"long"},{"name":"gt","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"pt","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"it","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"ut","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"nrd","type":"long"},{"name":"nrply","type":"long"},{"name":"url","type":"string"},{"name":"purl","type":"string"},{"name":"title","type":"string"},{"name":"author","type":"string"},{"name":"cont","type":"string"},{"name":"abstr","type":"string"},{"name":"lpic","type":{"type": "array", "items": "string"}},{"name":"lvideo","type":{"type": "array", "items": "string"}},{"name":"lkey","type":{"type": "array", "items": "string"}},{"name":"lang","type":"string"},{"name":"vkey","type":{"type":"array","items":{"type":"record","name":"vkey","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vpers","type":{"type":"array","items":{"type":"record","name":"vpers","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vorg","type":{"type":"array","items":{"type":"record","name":"vorg","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"vrgn","type":{"type":"array","items":{"type":"record","name":"vrgn","fields":[{"name":"v","type":"string"},{"name":"w","type":"long"}]}}},{"name":"sent","type":"long"},{"name":"i_bid","type":"long"},{"name":"i_bn","type":"string"},{"name":"i_sid","type":"long"},{"name":"i_sn","type":"string"},{"name":"adp","type":"string"},{"name":"loc","type":"string"}]}'
# KAFKA_APPNEWS_HEADERS = {"Content-Type": "application/vnd.kafka.avro.v2+json",
#                          "Accept": "application/vnd.kafka.v2+json"}
# KAFKA_APPNEWS_URL = "http://10.20.18.6:8082/topics/appnews_doc_crawler_v1_tmp"

# 招聘信息数据kafka配置信息
# KAFKA_RECRUIT_KEY_SCHEMA = '{"name":"_id" ,"type": "string"}'
# KAFKA_RECRUIT_VALUE_SCHEMA = '{"type":"record","name":"recruit_doc","fields":[{"name":"_key","type":"string"},{"name":"_spec","type":"string"},{"name":"_id","type":"string"},{"name":"_ch","type":"int"},{"name":"_dcm","type":"string"},{"name":"_adp","type":"string"},{"name":"lang","type":"string"},{"name":"tags","type":{"type":"array","items":"string"}},{"name":"gather_time","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"publish_time","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"insert_time","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"update_time","type":{"type":"long","logicalType":"timestamp-millis"}},{"name":"url","type":"string"},{"name":"site_id","type":"int"},{"name":"site_name","type":"string"},{"name":"job_name","type":"string"},{"name":"job_salary","type":"string"},{"name":"job_education","type":"string"},{"name":"job_number","type":"string"},{"name":"job_date_range","type":"string"},{"name":"job_description","type":"string"},{"name":"job_description_raw","type":"string"},{"name":"job_department","type":"string"},{"name":"job_address","type":"string"},{"name":"job_experience","type":"string"},{"name":"job_recruiter","type":"string"},{"name":"job_recruiter_position","type":"string"},{"name":"job_advantage","type":"string"},{"name":"company_name","type":"string"},{"name":"company_home_url","type":"string"},{"name":"company_logo","type":"string"},{"name":"company_industry","type":"string"},{"name":"company_development_stage","type":"string"},{"name":"company_scale","type":"string"},{"name":"company_description","type":"string"},{"name":"company_business_info","type":{"type":"record","name":"company_business_info","fields":[{"name":"company_name","type":"string"},{"name":"legal_representative","type":"string"},{"name":"registered_capital","type":"string"},{"name":"foundation_date","type":"string"},{"name":"business_type","type":"string"},{"name":"business_status","type":"string"},{"name":"registered_address","type":"string"},{"name":"uniform_code","type":"string"},{"name":"business_scope","type":"string"},{"name":"extra_info","type":"string"}]}},{"name":"extra_info","type":"string"}]}'
# KAFKA_RECRUIT_HEADERS = {"Content-Type": "application/vnd.kafka.avro.v2+json",
#                          "Accept": "application/vnd.kafka.v2+json"}
# KAFKA_RECRUIT_URL = "http://10.20.18.6:8082/topics/recruit_doc_crawler_v1"

# 智库信息数据kafka配置信息
# KAFKA_ZHIKU_KEY_SCHEMA = '{"name":"_id" ,"type": "string"}'
# KAFKA_ZHIKU_VALUE_SCHEMA = '{"type":"record","name":"avro","fields":[{"name":"_ch","type":"int"},{"name":"_id","type":"string"},{"name":"_key","type":"string"},{"name":"_spec","type":"string"},{"name":"_dcm","type":"string"},{"name":"_adp","type":"string"},{"name":"lang","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"abstract","type":["string","null"]},{"name":"content_raw","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"abstract_CN","type":["string","null"]},{"name":"tags","type":[{"type":"array","items":"string"},"null"]},{"name":"source","type":["string","null"]},{"name":"publish_time","type":"long"},{"name":"update_time","type":"long"},{"name":"gather_time","type":"long"},{"name":"insert_time","type":"long"},{"name":"cover_image_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"video_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"file_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"video_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"file_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"video_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"media_id","type":["string","null"]},{"name":"media_name","type":"string"},{"name":"media_url","type":["string","null"]},{"name":"media_location","type":[{"type":"array","items":"string"},"null"]},{"name":"board_id","type":["string","null"]},{"name":"board_name","type":["string","null"]},{"name":"board_url","type":["string","null"]},{"name":"board_name_full","type":[{"type":"array","items":"string"},"null"]},{"name":"url","type":"string"},{"name":"reposts_count","type":["int","null"]},{"name":"likes_count","type":["int","null"]},{"name":"dislikes_count","type":["int","null"]},{"name":"views_count","type":["int","null"]},{"name":"comments_count","type":["int","null"]},{"name":"attitudes_count","type":["int","null"]},{"name":"favourites_count","type":["int","null"]},{"name":"quoted_count","type":["int","null"]},{"name":"viewing_count","type":["int","null"]},{"name":"play_count","type":["int","null"]},{"name":"share_count","type":["int","null"]},{"name":"danmaku_count","type":["int","null"]},{"name":"keywords","type":[{"type":"array","items":"string"},"null"]},{"name":"keywords_vector","type":[{"type":"array","items":{"type":"record","name":"keywords_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"persons_vector","type":[{"type":"array","items":{"type":"record","name":"persons_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"organizations_vector","type":[{"type":"array","items":{"type":"record","name":"organizations_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"regions_vector","type":[{"type":"array","items":{"type":"record","name":"regions_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"message_type","type":"int"},{"name":"mention_list","type":[{"type":"array","items":"string"},"null"]},{"name":"topic_list","type":[{"type":"array","items":"string"},"null"]},{"name":"post_location","type":[{"type":"array","items":"string"},"null"]},{"name":"post_location_geo","type":[{"type":"array","items":"double"},"null"]},{"name":"root_id","type":["string","null"]},{"name":"parent_id","type":["string","null"]},{"name":"retweeted_status","type":[{"type":"record","name":"retweeted_status","fields":[{"name":"_id","type":["string","null"]},{"name":"_key","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"publish_time","type":["long","null"]},{"name":"url","type":["string","null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]}]},"null"]},{"name":"quoted_status","type":[{"type":"record","name":"quoted_status","fields":[{"name":"_id","type":["string","null"]},{"name":"_key","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"publish_time","type":["long","null"]},{"name":"url","type":["string","null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]}]},"null"]},{"name":"sentiment","type":"int"},{"name":"similar_id","type":["string","null"]},{"name":"is_public","type":"int"},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]},{"name":"author_screen_name","type":["string","null"]},{"name":"extra_info","type":["string","null"]},{"name":"group_id","type":["string","null"]},{"name":"group_name","type":["string","null"]},{"name":"author_full_info","type":[{"type":"record","name":"author_full_info","fields":[{"name":"uid","type":"string"},{"name":"name","type":["string","null"]},{"name":"screen_name","type":["string","null"]},{"name":"description","type":["string","null"]},{"name":"realname","type":["string","null"]},{"name":"emails","type":[{"type":"array","items":"string"},"null"]},{"name":"phonenumbers","type":[{"type":"array","items":"string"},"null"]},{"name":"gender","type":"int"},{"name":"birthday","type":["string","null"]},{"name":"profile_url","type":["string","null"]},{"name":"profile_image_url","type":["string","null"]},{"name":"cover_image","type":["string","null"]},{"name":"friends_count","type":["int","null"]},{"name":"bi_followers_count","type":["int","null"]},{"name":"favourites_count","type":["int","null"]},{"name":"followers_count","type":["int","null"]},{"name":"statuses_count","type":["int","null"]},{"name":"listed_count","type":["int","null"]},{"name":"accounts_status","type":["int","null"]},{"name":"tags","type":[{"type":"array","items":"string"},"null"]},{"name":"verified","type":"boolean"},{"name":"verified_type","type":"int"},{"name":"verified_reason","type":["string","null"]},{"name":"is_vip","type":"boolean"},{"name":"register_time","type":["long","null"]},{"name":"register_location","type":["string","null"]},{"name":"register_organization","type":["string","null"]},{"name":"in_organizations","type":[{"type":"array","items":"string"},"null"]},{"name":"groups","type":[{"type":"record","name":"groups","fields":[{"name":"group_id","type":"string"},{"name":"group_name","type":"string"},{"name":"group_description","type":["string","null"]},{"name":"group_owner","type":"string"},{"name":"group_members","type":"int"},{"name":"members","type":[{"type":"array","items":{"type":"record","name":"members","fields":[{"name":"id","type":"string"},{"name":"name","type":"string"}]}},"null"]},{"name":"extra_info","type":["string","null"]}]},"null"]},{"name":"extra_info","type":["string","null"]}]},"null"]}],"description":"avroschema"}'
# KAFKA_ZHIKU_HEADERS = {"Content-Type": "application/vnd.kafka.avro.v2+json",
#                          "Accept": "application/vnd.kafka.v2+json"}
# KAFKA_ZHIKU_URL = "http://10.20.18.6:8082/topics/zhiku_doc_crawler_v1_tmp1"


KAFKA_KEY_SCHEMA = '{"name":"_id" ,"type": "string"}'
KAFKA_VALUE_SCHEMA = '{"type":"record","name":"avro","fields":[{"name":"_ch","type":"int"},{"name":"_id","type":"string"},{"name":"_key","type":"string"},{"name":"_spec","type":"string"},{"name":"_dcm","type":"string"},{"name":"_adp","type":"string"},{"name":"lang","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"abstract","type":["string","null"]},{"name":"content_raw","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"abstract_CN","type":["string","null"]},{"name":"tags","type":[{"type":"array","items":"string"},"null"]},{"name":"source","type":["string","null"]},{"name":"publish_time","type":"long"},{"name":"update_time","type":"long"},{"name":"gather_time","type":"long"},{"name":"insert_time","type":"long"},{"name":"cover_image_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"video_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"file_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"video_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"file_paths","type":[{"type":"array","items":"string"},"null"]},{"name":"picture_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"audio_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"video_contents","type":[{"type":"array","items":"string"},"null"]},{"name":"media_id","type":["string","null"]},{"name":"media_name","type":"string"},{"name":"media_url","type":["string","null"]},{"name":"media_location","type":[{"type":"array","items":"string"},"null"]},{"name":"board_id","type":["string","null"]},{"name":"board_name","type":["string","null"]},{"name":"board_url","type":["string","null"]},{"name":"board_name_full","type":[{"type":"array","items":"string"},"null"]},{"name":"url","type":"string"},{"name":"reposts_count","type":["int","null"]},{"name":"likes_count","type":["int","null"]},{"name":"dislikes_count","type":["int","null"]},{"name":"views_count","type":["int","null"]},{"name":"comments_count","type":["int","null"]},{"name":"attitudes_count","type":["int","null"]},{"name":"favourites_count","type":["int","null"]},{"name":"quoted_count","type":["int","null"]},{"name":"viewing_count","type":["int","null"]},{"name":"play_count","type":["int","null"]},{"name":"share_count","type":["int","null"]},{"name":"danmaku_count","type":["int","null"]},{"name":"keywords","type":[{"type":"array","items":"string"},"null"]},{"name":"keywords_vector","type":[{"type":"array","items":{"type":"record","name":"keywords_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"persons_vector","type":[{"type":"array","items":{"type":"record","name":"persons_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"organizations_vector","type":[{"type":"array","items":{"type":"record","name":"organizations_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"regions_vector","type":[{"type":"array","items":{"type":"record","name":"regions_vector","fields":[{"name":"v","type":"string"},{"name":"w","type":"int"}]}},"null"]},{"name":"message_type","type":"int"},{"name":"mention_list","type":[{"type":"array","items":"string"},"null"]},{"name":"topic_list","type":[{"type":"array","items":"string"},"null"]},{"name":"post_location","type":[{"type":"array","items":"string"},"null"]},{"name":"post_location_geo","type":[{"type":"array","items":"double"},"null"]},{"name":"root_id","type":["string","null"]},{"name":"parent_id","type":["string","null"]},{"name":"retweeted_status","type":[{"type":"record","name":"retweeted_status","fields":[{"name":"_id","type":["string","null"]},{"name":"_key","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"publish_time","type":["long","null"]},{"name":"url","type":["string","null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]}]},"null"]},{"name":"quoted_status","type":[{"type":"record","name":"quoted_status","fields":[{"name":"_id","type":["string","null"]},{"name":"_key","type":["string","null"]},{"name":"title","type":["string","null"]},{"name":"content","type":["string","null"]},{"name":"title_CN","type":["string","null"]},{"name":"content_CN","type":["string","null"]},{"name":"publish_time","type":["long","null"]},{"name":"url","type":["string","null"]},{"name":"picture_urls","type":[{"type":"array","items":"string"},"null"]},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]}]},"null"]},{"name":"sentiment","type":"int"},{"name":"similar_id","type":["string","null"]},{"name":"is_public","type":"int"},{"name":"author_id","type":["string","null"]},{"name":"author_name","type":["string","null"]},{"name":"author_screen_name","type":["string","null"]},{"name":"extra_info","type":["string","null"]},{"name":"group_id","type":["string","null"]},{"name":"group_name","type":["string","null"]},{"name":"author_full_info","type":[{"type":"record","name":"author_full_info","fields":[{"name":"uid","type":"string"},{"name":"name","type":["string","null"]},{"name":"screen_name","type":["string","null"]},{"name":"description","type":["string","null"]},{"name":"realname","type":["string","null"]},{"name":"emails","type":[{"type":"array","items":"string"},"null"]},{"name":"phonenumbers","type":[{"type":"array","items":"string"},"null"]},{"name":"gender","type":"int"},{"name":"birthday","type":["string","null"]},{"name":"profile_url","type":["string","null"]},{"name":"profile_image_url","type":["string","null"]},{"name":"cover_image","type":["string","null"]},{"name":"friends_count","type":["int","null"]},{"name":"bi_followers_count","type":["int","null"]},{"name":"favourites_count","type":["int","null"]},{"name":"followers_count","type":["int","null"]},{"name":"statuses_count","type":["int","null"]},{"name":"listed_count","type":["int","null"]},{"name":"accounts_status","type":["int","null"]},{"name":"tags","type":[{"type":"array","items":"string"},"null"]},{"name":"verified","type":"boolean"},{"name":"verified_type","type":"int"},{"name":"verified_reason","type":["string","null"]},{"name":"is_vip","type":"boolean"},{"name":"register_time","type":["long","null"]},{"name":"register_location","type":["string","null"]},{"name":"register_organization","type":["string","null"]},{"name":"in_organizations","type":[{"type":"array","items":"string"},"null"]},{"name":"groups","type":[{"type":"record","name":"groups","fields":[{"name":"group_id","type":"string"},{"name":"group_name","type":"string"},{"name":"group_description","type":["string","null"]},{"name":"group_owner","type":"string"},{"name":"group_members","type":"int"},{"name":"members","type":[{"type":"array","items":{"type":"record","name":"members","fields":[{"name":"id","type":"string"},{"name":"name","type":"string"}]}},"null"]},{"name":"extra_info","type":["string","null"]}]},"null"]},{"name":"extra_info","type":["string","null"]}]},"null"]}],"description":"avroschema"}'
KAFKA_HEADERS = {"Content-Type": "application/vnd.kafka.avro.v2+json",
                 "Accept": "application/vnd.kafka.v2+json"}
KAFKA_ZHIKU_URL = "http://10.20.18.6:8082/topics/zhiku_doc_crawler_v1_tmp1"
KAFKA_NEWS_URL = "http://10.20.18.6:8082/topics/news_doc_crawler_v3_tmp1"
KAFKA_APP_NEWS_URL = 'http://10.20.18.6:8082/topics/appnews_doc_crawler_v1_tmp1'
KAFKA_APP_NEWS_COMMENTS_URL = 'http://10.20.18.6:8082/topics/appnews_comments_crawler_v1_tmp1'
KAFKA_WENDA_URL = 'http://10.20.18.6:8082/topics/wenda_doc_crawler_tmp1'
KAFKA_WEMEDIACOMMENT_URL = 'http://10.20.18.6:8082/topics/wemedia_comment_crawler_tmp1'


class GolaxyKafkaDataPersistorUtils(object):
    @classmethod
    def get_persist_kwargs(cls, item, item_type, **kwargs):
        _kwargs = dict()
        url = kwargs.get('url')
        key_schema = kwargs.get('key_schema') or KAFKA_KEY_SCHEMA
        value_schema = kwargs.get('value_schema') or KAFKA_VALUE_SCHEMA
        headers = kwargs.get('headers') or KAFKA_HEADERS
        if item_type == 'news':
            url = KAFKA_NEWS_URL
        elif item_type == 'app_news':
            url = KAFKA_APP_NEWS_URL
        elif item_type == 'app_news_comments':
            url = KAFKA_APP_NEWS_COMMENTS_URL
        elif item_type == 'zhiku':
            url = KAFKA_ZHIKU_URL
        elif item_type == 'wenda':
            url = KAFKA_WENDA_URL
        elif item_type == 'wemedia_comment':
            url = KAFKA_WEMEDIACOMMENT_URL
        body = [{'key': item['_key'], 'value': item}]
        data = json.dumps({'key_schema': key_schema, 'value_schema': value_schema, 'records': body})
        _kwargs['data'] = data
        _kwargs['headers'] = headers
        _kwargs['url'] = url
        _kwargs['method'] = 'post'
        return _kwargs


class GolaxyRequestsKafkaDataPersistor(object):
    @classmethod
    def persist(cls, item, item_type, **kwargs):

        _kwargs = GolaxyKafkaDataPersistorUtils.get_persist_kwargs(item, item_type, **kwargs)
        _kwargs['method'] = 'POST'
        response = GolaxyRequestsRequester.retry_request(retry=3, **_kwargs)
        # print(response.status_code)
        print(response.text)
